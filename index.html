<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-10-08 Wed 15:30 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
document.querySelectorAll('h1, h2, h3, h4, h5, h6').forEach(function(h) {
h.style.cursor = 'pointer';
const next = [];
let el = h.nextElementSibling;
while (el && !/^H[1-6]$/.test(el.tagName)) {
next.push(el);
el = el.nextElementSibling;
}
next.forEach(e => e.style.display = 'none');
h.addEventListener('click', () => {
const hidden = next[0].style.display === 'none';
next.forEach(e => e.style.display = hidden ? '' : 'none');
});
});
});
</script>
<style>
h1, h2, h3, h4, h5, h6::before {
content: "▶ ";
font-size: 0.8em;
transition: transform 0.2s;
}
h1.open::before, h2.open::before, h3.open::before,
h4.open::before, h5.open::before, h6.open::before {
content: "▼ ";
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
document.querySelectorAll('h1, h2, h3, h4, h5, h6').forEach(function(h) {
h.addEventListener('click', function() {
h.classList.toggle('close);
});
});
});
</script>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org23788b0">1. Importing data in Drupal&#xa0;&#xa0;&#xa0;<span class="tag"><span class="drupal">drupal</span></span></a>
<ul>
<li><a href="#org6d7bc81">1.1. Importing data</a></li>
<li><a href="#orgfff1a27">1.2. Rolling back</a></li>
<li><a href="#orgd735a88">1.3. yaml Template for import</a>
<ul>
<li><a href="#org78cfbcf">1.3.1. Minimum fields for migration</a></li>
<li><a href="#orgac712bf">1.3.2. Drupal plugins and their use to fill different fields in the migration</a></li>
</ul>
</li>
<li><a href="#org5418141">1.4. Content workflow; Imports</a></li>
<li><a href="#orgf0e7d9f">1.5. From Original record to innovation</a></li>
<li><a href="#orgde21d09">1.6. Notes</a></li>
</ul>
</li>
<li><a href="#org898b275">2. Error log: AI enhancement</a>
<ul>
<li><a href="#orgf5b595b">2.1. Data source not found in exception list</a></li>
<li><a href="#org87b5cc2">2.2. Cannot access offset of type string on string</a></li>
<li><a href="#orga577d26">2.3. OpenAI API doesn't handle strings</a></li>
<li><a href="#orgdf8b6b0">2.4. Examples of formatting errors when running a migration</a>
<ul>
<li><a href="#org5d26fdf">2.4.1. Whitespaces and different languages</a></li>
</ul>
</li>
<li><a href="#org811993a">2.5. Gemini API changed</a></li>
</ul>
</li>
<li><a href="#org2cb9d64">3. How to change taxonomy terms&#xa0;&#xa0;&#xa0;<span class="tag"><span class="drupal">drupal</span></span></a>
<ul>
<li><a href="#org1a0e04f">3.1. Custom Taxonomy</a></li>
</ul>
</li>
</ul>
</div>
</div>
---
layout: default
title: STI portal backend documentation
---
<div id="outline-container-org23788b0" class="outline-2">
<h2 id="org23788b0"><span class="section-number-2">1.</span> Importing data in Drupal&#xa0;&#xa0;&#xa0;<span class="tag"><span class="drupal">drupal</span></span></h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org6d7bc81" class="outline-3">
<h3 id="org6d7bc81"><span class="section-number-3">1.1.</span> Importing data</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>The general workflow from original record (<code>source_record</code>) to AI-extracted record (<code>extracted_entity</code>) and finally the innovation (<code>innovation</code>) you find on the user-facing website is:
<ol class="org-ol">
<li>write migration.yml file</li>
<li>upload source file (json, csv, &#x2026;) to <code>web/modules/custom/&lt;your_module_name&gt;/source/&lt;your_source_name_as_in_yml&gt;</code>)</li>
<li><code>drush migrate:import &lt;your migration id&gt;</code></li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-orgfff1a27" class="outline-3">
<h3 id="orgfff1a27"><span class="section-number-3">1.2.</span> Rolling back</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>This generally fails because of a malformatted migration file or typos etc in the source data, to rollback you do
<ol class="org-ol">
<li><code>drush migrate:stop &lt;your migration id&gt;</code> to stop any migration process going on</li>
<li><code>drush migrate:reset &lt;your migration id&gt;</code> to set the migration status to 'idle' (i.e. ready to import)</li>
<li><code>drush migrate:rollback &lt;your migration id&gt;</code> to remove any partially imported records</li>
</ol></li>
<li>Some notes on rollback: If you already have downstream content types based off of earlier imported source records, you're prone to create duplicates when rolling back &amp; re-importing the same sources. Your options are then:
<ol class="org-ol">
<li><code>drush migrate:rollback &lt;your migration id&gt; --update</code> to only update <code>source_record</code> that changed in the source data (because you e.g. changed the json structure)</li>
<li>Purge all downstream content by going to (Web menu -&gt; BACK-END -&gt; Manage &lt;content type&gt;)
<ol class="org-ol">
<li>Once there, filter for all content of interest, select the action 'Delete' from the Action drop-down and execute</li>
<li>You might need to do this 3 times, for 'Original Record', 'AI-extracted innovation record' and 'Innovation'</li>
<li>After purging existing data, you can run <code>drush migrate:import &lt;your migration id&gt;</code> again</li>
</ol></li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-orgd735a88" class="outline-3">
<h3 id="orgd735a88"><span class="section-number-3">1.3.</span> yaml Template for import</h3>
<div class="outline-text-3" id="text-1-3">
<div class="org-src-container">
<pre class="src src-yaml">    <span style="color: #cdd6f4;">uuid</span>: &lt;added after import, delete this column before importing&gt;
<span style="color: #cdd6f4;">langcode</span>: en
<span style="color: #cdd6f4;">status</span>: <span style="color: #fab387;">true</span>
<span style="color: #cdd6f4;">dependencies</span>:
  <span style="color: #cdd6f4;">enforced</span>:
    <span style="color: #cdd6f4;">module</span>:
      - &lt;import_STI_portal_data / import_IRD_jsons&gt;
<span style="color: #cdd6f4;">id</span>: &lt;machine reference to this migration&gt;
<span style="color: #cdd6f4;">class</span>: <span style="color: #fab387;">null</span>
<span style="color: #cdd6f4;">field_plugin_method</span>: <span style="color: #fab387;">null</span>
<span style="color: #cdd6f4;">cck_plugin_method</span>: <span style="color: #fab387;">null</span>
<span style="color: #cdd6f4;">migration_tags</span>: STI
<span style="color: #cdd6f4;">migration_group</span>: STI-import-group
<span style="color: #cdd6f4;">label</span>: &lt;description, e.g. the one found in Manage data sources&gt;
<span style="color: #cdd6f4;">source</span>:
  <span style="color: #cdd6f4;">plugin</span>: &lt;csv / json&gt;
  <span style="color: #cdd6f4;">constants</span>:
    <span style="color: #cdd6f4;">SOURCE</span>: &lt;source name as found in Manage data sources&gt;
    <span style="color: #cdd6f4;">SOURCE_ID</span>: &lt;source name as found in the Manage data sources url&gt;
    <span style="color: #cdd6f4;">RECTYPE</span>: &lt;check what rectypes are set in Mange data source&gt;
  <span style="color: #cdd6f4;">path</span>: &lt;path to the json or csv file to migrate&gt;
  <span style="color: #cdd6f4;">header_offset</span>: 0
  <span style="color: #cdd6f4;">ids</span>:
    - &lt;the data column containing unique IDs, eg. id, url, title&gt;
<span style="color: #cdd6f4;">process</span>:
  <span style="color: #cdd6f4;">field_data_source</span>: constants/SOURCE_ID <span style="color: #6c7086;"># </span><span style="color: #6c7086;">Needed so that imported records are assigned to the correct data source
</span>  <span style="color: #cdd6f4;">field_original_internal_id</span>:
    <span style="color: #cdd6f4;">plugin</span>: skip_on_empty
    <span style="color: #cdd6f4;">source</span>: &lt;give the same as set in <span style="color: #a6e3a1;">'ids'</span> above&gt;
    <span style="color: #cdd6f4;">method</span>: row
    <span style="color: #cdd6f4;">message</span>: <span style="color: #a6e3a1;">'Row does not contain Project Symbol: skipped'</span>
  <span style="color: #cdd6f4;">title</span>:
    <span style="color: #cdd6f4;">plugin</span>: skip_on_empty
    <span style="color: #cdd6f4;">source</span>: &lt;data column containing the name/title of the entry&gt;
    <span style="color: #cdd6f4;">method</span>: row
    <span style="color: #cdd6f4;">message</span>: <span style="color: #a6e3a1;">'Row does not contain title: skipped'</span>
  <span style="color: #cdd6f4;">type</span>:
    <span style="color: #cdd6f4;">plugin</span>: default_value
    <span style="color: #cdd6f4;">default_value</span>: source_record <span style="color: #6c7086;"># </span><span style="color: #6c7086;">leave unchanged, you're importing a 'source_record'
</span>  <span style="color: #cdd6f4;">field_shorter_description/value</span>:
    <span style="color: #cdd6f4;">-
      plugin</span>: skip_on_empty
      <span style="color: #cdd6f4;">source</span>: &lt;data column containing a 1-2 sentence description&gt;
      <span style="color: #cdd6f4;">method</span>: process
      <span style="color: #cdd6f4;">message</span>: <span style="color: #a6e3a1;">'Row does not contain short descr.'</span>
  <span style="color: #cdd6f4;">field_shorter_description/format</span>:
    <span style="color: #cdd6f4;">plugin</span>: default_value
    <span style="color: #cdd6f4;">default_value</span>: full_html
  <span style="color: #cdd6f4;">field_long_description/value</span>:
    <span style="color: #cdd6f4;">-
      plugin</span>: skip_on_empty
      <span style="color: #cdd6f4;">source</span>: &lt;data column containing a long freetext description&gt;
      <span style="color: #cdd6f4;">method</span>: process
      <span style="color: #cdd6f4;">message</span>: <span style="color: #a6e3a1;">'Row does not contain short descr.'</span>
  <span style="color: #cdd6f4;">field_long_description/format</span>:
    <span style="color: #cdd6f4;">plugin</span>: default_value
    <span style="color: #cdd6f4;">default_value</span>: full_html
  <span style="color: #cdd6f4;">time</span>:
    <span style="color: #cdd6f4;">plugin</span>: callback
    <span style="color: #cdd6f4;">callable</span>: time
    <span style="color: #cdd6f4;">unpack_source</span>: <span style="color: #fab387;">true</span>
    <span style="color: #cdd6f4;">source</span>: {  <span style="color: #cdd6f4;">}
  field_impact_sdgs</span>:
    - <span style="color: #cdd6f4;">plugin</span>: explode
      <span style="color: #cdd6f4;">delimiter</span>: <span style="color: #a6e3a1;">','</span>
      <span style="color: #cdd6f4;">source</span>: &lt;data column mentioning sdgs&gt;
    - <span style="color: #cdd6f4;">plugin</span>: callback
      <span style="color: #cdd6f4;">callable</span>: trim
    - <span style="color: #cdd6f4;">plugin</span>: preg_replace
      <span style="color: #cdd6f4;">pattern</span>: <span style="color: #a6e3a1;">'\..*'</span>
      <span style="color: #cdd6f4;">replace</span>: <span style="color: #a6e3a1;">''</span>
    - 
      <span style="color: #6c7086;"># </span><span style="color: #6c7086;">Often it is necessary to map however sdgs are named in the source data to the STI portal taxonomy
</span>      <span style="color: #cdd6f4;">plugin</span>: static_map
      <span style="color: #cdd6f4;">map</span>:
        <span style="color: #a6e3a1;">'1'</span>: <span style="color: #a6e3a1;">'Goal 1: No poverty'</span>
        <span style="color: #a6e3a1;">'2'</span>: <span style="color: #a6e3a1;">'Goal 2: Zero hunger'</span>
        <span style="color: #a6e3a1;">'3'</span>: <span style="color: #a6e3a1;">'Goal 3: Good health and well-being'</span>
        <span style="color: #a6e3a1;">'4'</span>: <span style="color: #a6e3a1;">'Goal 4: Quality education'</span>
        <span style="color: #a6e3a1;">'5'</span>: <span style="color: #a6e3a1;">'Goal 5: Gender equality'</span>
        <span style="color: #a6e3a1;">'6'</span>: <span style="color: #a6e3a1;">'Goal 6: Clean water and sanitation'</span>
        <span style="color: #a6e3a1;">'7'</span>: <span style="color: #a6e3a1;">'Goal 7: Affordable and clean energy'</span>
        <span style="color: #a6e3a1;">'8'</span>: <span style="color: #a6e3a1;">'Goal 8: Decent work and economic growth'</span>
        <span style="color: #a6e3a1;">'9'</span>: <span style="color: #a6e3a1;">'Goal 9: Industry, innovation and infrastructure'</span>
        <span style="color: #a6e3a1;">'10'</span>: <span style="color: #a6e3a1;">'Goal 10: Reduced inequalities'</span>
        <span style="color: #a6e3a1;">'11'</span>: <span style="color: #a6e3a1;">'Goal 11: Sustainable cities and communities'</span>
        <span style="color: #a6e3a1;">'12'</span>: <span style="color: #a6e3a1;">'Goal 12: Responsible consumption and production'</span>
        <span style="color: #a6e3a1;">'13'</span>: <span style="color: #a6e3a1;">'Goal 13: Climate action'</span>
        <span style="color: #a6e3a1;">'14'</span>: <span style="color: #a6e3a1;">'Goal 14: Life below water'</span>
        <span style="color: #a6e3a1;">'15'</span>: <span style="color: #a6e3a1;">'Goal 15: Life on land'</span>
        <span style="color: #a6e3a1;">'16'</span>: <span style="color: #a6e3a1;">'Goal 16: Peace, justice and strong institutions'</span>
        <span style="color: #a6e3a1;">'17'</span>: <span style="color: #a6e3a1;">'Goal 17: Partnerships for the goals'</span>
      <span style="color: #cdd6f4;">default_value</span>: <span style="color: #a6e3a1;">''</span>
    <span style="color: #cdd6f4;">-
      plugin</span>: entity_lookup
      <span style="color: #cdd6f4;">entity_type</span>: taxonomy_term
      <span style="color: #cdd6f4;">ignore_case</span>: <span style="color: #fab387;">true</span>
      <span style="color: #cdd6f4;">value_key</span>: name
      <span style="color: #cdd6f4;">bundle</span>: impact_sdgs
  <span style="color: #cdd6f4;">field_region</span>:
  <span style="color: #cdd6f4;">-
    plugin</span>: entity_generate 
    <span style="color: #cdd6f4;">entity_type</span>: taxonomy_term
    <span style="color: #cdd6f4;">ignore_case</span>: <span style="color: #fab387;">true</span>
    <span style="color: #cdd6f4;">value_key</span>: name
    <span style="color: #cdd6f4;">source</span>: &lt;region column or field&gt;
    <span style="color: #cdd6f4;">bundle</span>: countries_no_standard
  <span style="color: #cdd6f4;">field_innovation_type</span>:
  <span style="color: #cdd6f4;">-
    plugin</span>: explode
    <span style="color: #cdd6f4;">source</span>: &lt;innovation column or field&gt;
    <span style="color: #cdd6f4;">delimiter</span>: <span style="color: #a6e3a1;">'-'</span>
  - <span style="color: #cdd6f4;">plugin</span>: callback
    <span style="color: #cdd6f4;">callable</span>: trim
  <span style="color: #cdd6f4;">-
    plugin</span>: entity_lookup
    <span style="color: #cdd6f4;">entity_type</span>: taxonomy_term
    <span style="color: #cdd6f4;">ignore_case</span>: <span style="color: #fab387;">true</span>
    <span style="color: #cdd6f4;">value_key</span>: name
    <span style="color: #cdd6f4;">bundle</span>: type
  <span style="color: #cdd6f4;">field_use_cases</span>:
  <span style="color: #cdd6f4;">-
    plugin</span>: explode
    <span style="color: #cdd6f4;">source</span>: &lt;use cases column or field&gt;
    <span style="color: #cdd6f4;">delimiter</span>: <span style="color: #a6e3a1;">'-'</span>
  - <span style="color: #cdd6f4;">plugin</span>: callback
    <span style="color: #cdd6f4;">callable</span>: trim
  <span style="color: #cdd6f4;">-
    plugin</span>: entity_lookup
    <span style="color: #cdd6f4;">entity_type</span>: taxonomy_term
    <span style="color: #cdd6f4;">ignore_case</span>: <span style="color: #fab387;">true</span>
    <span style="color: #cdd6f4;">value_key</span>: name
    <span style="color: #cdd6f4;">bundle</span>: use_cases
  <span style="color: #cdd6f4;">field_adoption_countries_ns</span>: <span style="color: #6c7086;"># </span><span style="color: #6c7086;">this field is needed in case country names do not follow the UN/FAO - Standards
</span>    - 
      <span style="color: #cdd6f4;">plugin</span>: skip_on_empty
      <span style="color: #cdd6f4;">method</span>: process
      <span style="color: #cdd6f4;">source</span>: &lt;use cases column or field&gt;
    <span style="color: #cdd6f4;">-
      plugin</span>: explode
      <span style="color: #cdd6f4;">delimiter</span>: <span style="color: #a6e3a1;">'-'</span>
    <span style="color: #cdd6f4;">-
      plugin</span>: entity_generate
      <span style="color: #cdd6f4;">entity_type</span>: taxonomy_term
      <span style="color: #cdd6f4;">ignore_case</span>: <span style="color: #fab387;">true</span>
      <span style="color: #cdd6f4;">value_key</span>: name
      <span style="color: #cdd6f4;">bundle</span>: countries_no_standard
<span style="color: #cdd6f4;">destination</span>:
  <span style="color: #cdd6f4;">plugin</span>: <span style="color: #a6e3a1;">'entity:node'</span>
  <span style="color: #cdd6f4;">default_bundle</span>: source_record
  <span style="color: #cdd6f4;">overwrite_properties</span>:
    - field_data_source
    - field_original_internal_id
    - field_shorter_description/value
    - field_long_description/value
<span style="color: #cdd6f4;">migration_dependencies</span>:
  <span style="color: #cdd6f4;">required</span>: {  }

</pre>
</div>
<ul class="org-ul">
<li><p>
The migration has 4 top-level parts:
</p>
<ol class="org-ol">
<li>The header sections <code>id</code>, <code>label</code>, etc</li>
<li><code>source</code> describing the source data and its structure</li>
<li><code>process</code> describing how to read, process and pass on the source data fields</li>
<li><code>destination</code> describing where the data is supposed to end up. Just put:</li>
</ol>
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #cdd6f4;">plugin</span>: <span style="color: #a6e3a1;">'entity:node'</span>
<span style="color: #cdd6f4;">default_bundle</span>: source_record
</pre>
</div></li>
</ul>
</div>
<div id="outline-container-org78cfbcf" class="outline-4">
<h4 id="org78cfbcf"><span class="section-number-4">1.3.1.</span> Minimum fields for migration</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
What should you parse out from the data? What should be there? I think the list below is good for a start:
</p>
<ul class="org-ul">
<li><code>title</code></li>
<li><code>field_original_internal_id</code></li>
<li><code>field_shorter_description</code></li>
<li><code>field_long_description</code></li>
</ul>
</div>
<ol class="org-ol">
<li><a id="org9e79841"></a>Additional: Should be sourced from the data<br />
<div class="outline-text-5" id="text-1-3-1-1">
<ul class="org-ul">
<li><code>field_link</code></li>
<li><code>field_owner</code></li>
<li><code>field_impact_sdgs</code></li>
<li><code>field_country_origin</code></li>
<li><code>field_countries_adoption</code></li>
</ul>
</div>
</li>
</ol>
</div>
<div id="outline-container-orgac712bf" class="outline-4">
<h4 id="orgac712bf"><span class="section-number-4">1.3.2.</span> Drupal plugins and their use to fill different fields in the migration</h4>
<div class="outline-text-4" id="text-1-3-2">
</div>
<ol class="org-ol">
<li><a id="org9100139"></a><code>entity_lookup</code>, <code>skip_on_empty</code> and <code>explode</code><br />
<div class="outline-text-5" id="text-1-3-2-1">
<ul class="org-ul">
<li>Example</li>
</ul>
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #cdd6f4;">field_adoption_countries_ns</span>: <span style="color: #6c7086;"># </span><span style="color: #6c7086;">this field is needed in case country names do not follow the UN/FAO - Standards
</span>- 
  <span style="color: #cdd6f4;">plugin</span>: skip_on_empty
  <span style="color: #cdd6f4;">method</span>: process
  <span style="color: #cdd6f4;">source</span>: &lt;use cases column or field&gt;
<span style="color: #cdd6f4;">-
  plugin</span>: explode
  <span style="color: #cdd6f4;">delimiter</span>: <span style="color: #a6e3a1;">'-'</span>
<span style="color: #cdd6f4;">-
  plugin</span>: entity_generate
  <span style="color: #cdd6f4;">entity_type</span>: taxonomy_term
  <span style="color: #cdd6f4;">ignore_case</span>: <span style="color: #fab387;">true</span>
  <span style="color: #cdd6f4;">value_key</span>: name
  <span style="color: #cdd6f4;">bundle</span>: countries_no_standard
</pre>
</div>
<ul class="org-ul">
<li>Explanation:
<ul class="org-ul">
<li>Multiple plugins can be chained like above. The execution order is top-to-bottom. The first plugin must receive the <code>source</code> data column or field.</li>
<li><code>skip_on_empty</code> is a sanity check. If the field/column is not filled for this row or entry, it will simply not be filled (and skipped). This avoids errors when migrating data with empty fields. You need to give it a <code>method:</code> (process or row)</li>
<li><code>explode</code> is used if a field/column contains multiple values. In a csv file it might be that '|' or '-' are used as a separator for a 'unclean' field containing more than one value</li>
<li><code>entity_generate</code> generates a new taxonomy term if no exactly matching one can be found (e.g. data uses 'FAO' while taxonomy expects 'Food and Agriculture Organization of the United Nations'. That can either be cleaned up later by manually replacing <i>or</i> one uses ai-mapping logic like is done for the <code>field_adoption_countries_ns</code> entry. It finds the closest real taxonomy term and automatically replaces them</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org042b980"></a><code>static_map</code><br />
<div class="outline-text-5" id="text-1-3-2-2">
<ul class="org-ul">
<li>Example:</li>
</ul>
<div class="org-src-container">
<pre class="src src-yaml">- 
  <span style="color: #6c7086;"># </span><span style="color: #6c7086;">Often it is necessary to map however sdgs are named in the source data to the STI portal taxonomy
</span>  <span style="color: #cdd6f4;">plugin</span>: static_map
  <span style="color: #cdd6f4;">map</span>:
    <span style="color: #a6e3a1;">'1'</span>: <span style="color: #a6e3a1;">'Goal 1: No poverty'</span>
    <span style="color: #a6e3a1;">'2'</span>: <span style="color: #a6e3a1;">'Goal 2: Zero hunger'</span>
    <span style="color: #a6e3a1;">'3'</span>: <span style="color: #a6e3a1;">'Goal 3: Good health and well-being'</span>
    <span style="color: #a6e3a1;">'4'</span>: <span style="color: #a6e3a1;">'Goal 4: Quality education'</span>
    <span style="color: #a6e3a1;">'5'</span>: <span style="color: #a6e3a1;">'Goal 5: Gender equality'</span>
    <span style="color: #a6e3a1;">'6'</span>: <span style="color: #a6e3a1;">'Goal 6: Clean water and sanitation'</span>
    <span style="color: #a6e3a1;">'7'</span>: <span style="color: #a6e3a1;">'Goal 7: Affordable and clean energy'</span>
    <span style="color: #a6e3a1;">'8'</span>: <span style="color: #a6e3a1;">'Goal 8: Decent work and economic growth'</span>
    <span style="color: #a6e3a1;">'9'</span>: <span style="color: #a6e3a1;">'Goal 9: Industry, innovation and infrastructure'</span>
    <span style="color: #a6e3a1;">'10'</span>: <span style="color: #a6e3a1;">'Goal 10: Reduced inequalities'</span>
    <span style="color: #a6e3a1;">'11'</span>: <span style="color: #a6e3a1;">'Goal 11: Sustainable cities and communities'</span>
    <span style="color: #a6e3a1;">'12'</span>: <span style="color: #a6e3a1;">'Goal 12: Responsible consumption and production'</span>
    <span style="color: #a6e3a1;">'13'</span>: <span style="color: #a6e3a1;">'Goal 13: Climate action'</span>
    <span style="color: #a6e3a1;">'14'</span>: <span style="color: #a6e3a1;">'Goal 14: Life below water'</span>
    <span style="color: #a6e3a1;">'15'</span>: <span style="color: #a6e3a1;">'Goal 15: Life on land'</span>
    <span style="color: #a6e3a1;">'16'</span>: <span style="color: #a6e3a1;">'Goal 16: Peace, justice and strong institutions'</span>
    <span style="color: #a6e3a1;">'17'</span>: <span style="color: #a6e3a1;">'Goal 17: Partnerships for the goals'</span>
  <span style="color: #cdd6f4;">default_value</span>: <span style="color: #a6e3a1;">''</span>
</pre>
</div>
<ul class="org-ul">
<li>Explanation: This plugin works if you can guarantee a one-to-one mapping of how data entries are written in the data source to how they are represented in the taxonomy. On the left-hand side of the colon put the way the entry is written in the data source, on the right side the way its written in the taxonomy. Right-hand side seems to ignore case, but make sure that the entries are written exactly matching to the taxonomy terms.</li>
</ul>
</div>
</li>
<li><a id="orge8d503a"></a><code>entity_lookup</code><br />
<div class="outline-text-5" id="text-1-3-2-3">
<ul class="org-ul">
<li>Example</li>
</ul>
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #cdd6f4;">field_type_of_information_manage</span>:
  <span style="color: #cdd6f4;">plugin</span>: entity_lookup
  <span style="color: #cdd6f4;">entity_type</span>: taxonomy_term
  <span style="color: #cdd6f4;">ignore_case</span>: <span style="color: #fab387;">true</span>
  <span style="color: #cdd6f4;">value_key</span>: name
  <span style="color: #cdd6f4;">source</span>: constants/RECTYPE
  <span style="color: #cdd6f4;">bundle</span>: source_entity_types
</pre>
</div>
<ul class="org-ul">
<li>Explanation: Fill in the corresponding term fromt he taxonomy found in the corresponding bundle. This needs to be an exact match, i.e. this step is done after <code>static_map</code> or using a pre-defined constant like in the example.</li>
<li>to find the correct machine name for the bundle in question go to Web menu -&gt; About -&gt; Taxonomies -&gt; &lt;click on taxonomy&gt; -&gt; &lt;click on the taxonomy name/title again&gt;. You should find the Machine name next to the title</li>
</ul>
</div>
</li>
<li><a id="org9c853e7"></a><br /></li>
</ol>
</div>
</div>
<div id="outline-container-org5418141" class="outline-3">
<h3 id="org5418141"><span class="section-number-3">1.4.</span> Content workflow; Imports</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>This commands lists all content types' machine names</li>
</ul>
<div class="org-src-container">
<pre class="src src-nil">  drush eval "print_r(array_keys(\Drupal::entityTypeManager()-&gt;getStorage('node_type')-&gt;loadMultiple()));"

Array
(
    [0] =&gt; asti_data
    [1] =&gt; definitions
    [2] =&gt; digital_asset
    [3] =&gt; extracted_entity
    [4] =&gt; initiative
    [5] =&gt; innovation
    [6] =&gt; innovation_core
    [7] =&gt; innovation_extracted_from_origin
    [8] =&gt; internal_content
    [9] =&gt; learning_resource
    [10] =&gt; organization
    [11] =&gt; source_record
    [12] =&gt; taxonomy_description
    [13] =&gt; web_page
    [14] =&gt; website_section
)
</pre>
</div>
<ul class="org-ul">
<li>To find out which fields are available for each content type, run</li>
</ul>
<div class="org-src-container">
<pre class="src src-nil">drush field:info node &lt;e.g. source_record&gt;
</pre>
</div>
<ul class="org-ul">
<li>This will give you an idea which information should ideally already be present when importing the data</li>
<li>To understand what those fields are supposed to contain, you can consult the taxonomy page (Web menu -&gt; About -&gt; Taxonomies -&gt; &lt;e.g. Use Cases&gt;
<ul class="org-ul">
<li>This will help you understand if the data source of choice has a matching taxonomy</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgf0e7d9f" class="outline-3">
<h3 id="orgf0e7d9f"><span class="section-number-3">1.5.</span> From Original record to innovation</h3>
<div class="outline-text-3" id="text-1-5">
<ol class="org-ol">
<li>Web menu -&gt; BACK-END -&gt; manage data sources
<ul class="org-ul">
<li>Search: &lt;your data source&gt;</li>
<li>Edit tag: STI portal data source (also ATIO, should the data be imported into ATIO)</li>
<li>Publish (I encountered problems with the AI-enhancement if I didn't do this)</li>
<li>select if
<ul class="org-ul">
<li>can be overwritten by AI</li>
<li>allow overwriting by original record</li>
<li>allow overwriting by extracted innovation record</li>
</ul></li>
</ul></li>
<li>Web menu -&gt; BACK-END -&gt; Workflows for original records 
<ul class="org-ul">
<li>Source: &lt;your data source&gt; (should auto-complete at this point)</li>
<li>filter</li>
<li>select all</li>
<li>generate/update extracted innovations from original records</li>
</ul></li>
<li>Web menu -&gt; BACK-END -&gt; Workflows for ai-extracted innovations
<ol class="org-ol">
<li>Enrich derived innovation record with AI if empty (settings allow a bit less cautious)
<ul class="org-ul">
<li>max 250, better 50 at a time (otherwise you risk a timeout error)</li>
<li>if not loading, change the 'start' in the url for 'stop': <code>https://sti-portal-prototype.net/stiportal_dev/web/batch?id=3342&amp;op=start</code> -&gt; <code>https://sti-portal-prototype.net/stiportal_dev/web/batch?id=3342&amp;op=stop</code></li>
</ul></li>
<li>Generate/update innovation records from AI extracted records
<ul class="org-ul">
<li>to see what can go wrong &amp; how to fix it: <a href="#org898b275">Error log: AI enhancement</a></li>
</ul></li>
<li>Check that the innovations are displayed correctly in the website if you open your data source's collection page</li>
</ol></li>
</ol>
</div>
</div>
<div id="outline-container-orgde21d09" class="outline-3">
<h3 id="orgde21d09"><span class="section-number-3">1.6.</span> Notes</h3>
<div class="outline-text-3" id="text-1-6">
<ul class="org-ul">
<li>Make sure that there are no duplicates in the source data. This means whatever field is used as 'id' is truly unique. Good candidates are project numbers, urls or, if no alternative, the full title</li>
<li>'Titles' have a character limit</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org898b275" class="outline-2">
<h2 id="org898b275"><span class="section-number-2">2.</span> Error log: AI enhancement</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgf5b595b" class="outline-3">
<h3 id="orgf5b595b"><span class="section-number-3">2.1.</span> Data source not found in exception list</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li><p>
Error:
</p>
<div class="org-src-container">
<pre class="src src-nil">Check action successor current_prov_id (Activity_12o35fp) from ECA VBO - Generate / update AI derived innovation records from original records (process_yoqnpd7) for event eca_vbo.execute.
- session_user (Entity user/46/wiessalla) - entity (Entity node/source_record/35689/ Corte (Poda) das folhas do coqueiro na região de Bicol)
- node (Entity node/source_record/35689/ Corte (Poda) das folhas do coqueiro na região de Bicol)
- except_providers_view (DTO) - 
0 (Entity node/digital_asset/28182/Country Annual Report (CAR)) - 
1 (Entity node/digital_asset/28184/Digital Agriculture Programme Priority Area (BP5) ) - 
2 (Entity node/digital_asset/25260/Seeding The Future Global Food System Innovation Database and Network) - 
3 (Entity node/digital_asset/19987/Technologies for African Agricultural Transformation (TAAT)) - 
4 (Entity node/digital_asset/20007/World Overview of Conservation Approaches and Technologies (WOCAT)) - exception_provider (DTO "0") - exceptions_count (DTO "0") - provider_id_read (DTO "28182") - provider_id (DTO "28182") - exception_providers_list (DTO) - 
0 (DTO "20007") - 1 (DTO "19987") - 2 (DTO "25260") - 3 (DTO "28184") - 
4 (DTO "28182") - orig_rec (Entity node/source_record/35689/ Corte (Poda) das folhas do coqueiro na região de Bicol) - rec_sources (DTO) - 
0 (Entity node/digital_asset/4/FAO Technologies and Practices for Small Agricultural Producers (TECA))
- counter (DTO "-17243") - current_prov_id (NULL) - user (Entity user/1/admin) - event (DTO)
- view (DTO) - id (string "backend2") - display_id (string "page_7") - action (DTO)
- plugin (string "eca_vbo_execute:generate_update_extracted_innovations_from_original_records")
- config (DTO) - operation_name (string "Generate / update extracted innovations from original records") - message_override (string "")
- skip_confirm (integer "0") - entity (DTO) - id (string "35689")
- label (string " Corte (Poda) das folhas do coqueiro na região de Bicol")
- type (string "node") - bundle (string "source_record") - langcode (string "en") - machine_name (string "eca_vbo.execute")
</pre>
</div>
<ul class="org-ul">
<li>Explanation: In the example I was trying to add new AI-extracted innovations to the provider 'TECA' with the <code>provider_id</code> 4. This id was not found and not added to the <code>exception_providers_list</code>. The import enters an infinite loop and fails with HTTP Error 500.</li>
<li>Solution: For me, setting the data source's status to 'published' worked</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org87b5cc2" class="outline-3">
<h3 id="org87b5cc2"><span class="section-number-3">2.2.</span> Cannot access offset of type string on string</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li><p>
Error:
</p>
<div class="org-src-container">
<pre class="src src-nil">ResponseText: The website encountered an unexpected error. Try again later.
TypeError: Cannot access offset of type string on string in Drupal\ai_automators\PluginBaseClasses\Boolean-&gt;verifyValue()
(line 94 of modules/contrib/ai/modules/ai_automators/src/PluginBaseClasses/Boolean.php).
</pre>
</div></li>
<li>the same error is thrown on line 110
<ul class="org-ul">
<li>Explanation: Some boolean elements in the ECA (such as whether or not the field 'overwrite existing entries by AI' is checked in the data source settings) are apparently passed as strings through the ECA. The Boolean.php of the <code>ai_automators</code> plugin (<code>web/modules/contrib/ai/modules/ai_automators/src/PluginBaseClasses/Boolean.php</code>)</li>
</ul></li>
</ul>
<p>
takes only arrays in line 94 and 110.
</p>
<ul class="org-ul">
<li><p>
Solution: As a hotfix I forced casting every value that is not an array to an array. That seems to work for now
</p>
<div class="org-src-container">
<pre class="src src-php">public function verifyValue(ContentEntityInterface $entity, $value, FieldDefinitionInterface $fieldDefinit    ion, array $automatorConfig) {
  // Has to be string boolean.
  if (!is_array($value)) { #! changed
    $value = ['value' =&gt; $value];
  }
  if (!in_array($value['value'], ['TRUE', 'FALSE', '0', '1', 0, 1])) {
    return FALSE;
  }
  // Otherwise it is ok.
  return TRUE;
}

/**
 * {@inheritDoc}
 */
public function storeValues(ContentEntityInterface $entity, array $values, FieldDefinitionInterface $field    Definition, array $automatorConfig) {
  // Transform string to boolean.
  foreach ($values as $key =&gt; $value) {
    if (!is_array($value)) { #! changed 
      $value = ['value' =&gt; $value];
    }
    $values[$key] = in_array($value['value'], ['TRUE', '1', 1]) ? TRUE : FALSE;
  }
  // Then set the value.
  $entity-&gt;set($fieldDefinition-&gt;getName(), $values);
  return TRUE;
}
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-orga577d26" class="outline-3">
<h3 id="orga577d26"><span class="section-number-3">2.3.</span> OpenAI API doesn't handle strings</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li><p>
Error:
</p>
<div class="org-src-container">
<pre class="src src-nil">TypeError: OpenAI\Responses\Chat\CreateResponse::from():
Argument #1 ($attributes) must be of type array, string given,
called in /home/stiprototype/public_html/stiportal_dev/vendor/openai-php/client/src/Resources/Chat.php on line 35 in OpenAI\Responses\Chat\CreateResponse::from()
(line 46 of /home/stiprototype/public_html/stiportal_dev/vendor/openai-php/client/src/Responses/Chat/CreateResponse.php).
</pre>
</div></li>
<li>Explanation: Like in <a href="#org87b5cc2">this error</a> the ECA that does the AI-enrichment seems to pass a string where an array is expected</li>
<li>Solution:
<ul class="org-ul">
<li>Changing the php code and forcing strings to array could work</li>
<li>Fundamentally, the issue should be addressed in the ECA</li>
<li>Changing the API from OpenAI to Anthropic avoids the issue so I did this</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgdf8b6b0" class="outline-3">
<h3 id="orgdf8b6b0"><span class="section-number-3">2.4.</span> Examples of formatting errors when running a migration</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-org5d26fdf" class="outline-4">
<h4 id="org5d26fdf"><span class="section-number-4">2.4.1.</span> Whitespaces and different languages</h4>
<div class="outline-text-4" id="text-2-4-1">
<ul class="org-ul">
<li><p>
Error:
</p>
<div class="org-src-container">
<pre class="src src-nil">
#+begin_src 
4536 1 teca:field_information_resource_date:format_date: Format date plugin could not transform 'Augst 
2006' using the format 'F Y'. Error: The date cannot be created from a format. 
8363 1 teca:field_information_resource_date:format_date: Format date plugin could not transform '
2015' using the format 'F Y'. Error: The date cannot be created from a format. 
8653 1 teca:field_information_resource_date:format_date: Format date plugin could not transform 'February 
2016 ' using the format 'F Y'. Error: The date cannot be created from a format. 
8707 1 teca:field_information_resource_date:format_date: Format date plugin could not transform ' April 
2016 ' using the format 'F Y'. Error: The date cannot be created from a format. 
2471 1 teca:field_information_resource_date:format_date: Format date plugin could not transform 'August 
2015 ' using the format 'F Y'. Error: The date cannot be created from a format. 
2699 1 teca:field_information_resource_date:format_date: Format date plugin could not transform 'May 
2013 ' using the format 'F Y'. Error: The date cannot be created from a format. 
2019 1 teca:field_information_resource_date:format_date: Format date plugin could not transform 'May 
2011 ' using the format 'F Y'. Error: The date cannot be created from a format. 
2466 1 teca:field_information_resource_date:format_date: Format date plugin could not transform 'March 
2005 ' using the format 'F Y'. Error: The date cannot be created from a format. 
2555 1 teca:field_information_resource_date:format_date: Format date plugin could not transform 'March 
2018 ' using the format 'F Y'. Error: The date cannot be created from a format. 
10038 1 teca:field_information_resource_date:format_date: Format date plugin could not transform 'May 
2015 ' using the format 'F Y'. Error: The date cannot be created from a format. 
10126 1 teca:field_information_resource_date:format_date: Format date plugin could not transform ' April 
2021' using the format 'F Y'. Error: The date cannot be created from a format. 
10105 1 teca:field_information_resource_date:format_date: Format date plugin could not transform 'Février 
2015' using the format 'F Y'. Error: The date cannot be created from a format. 
10106 1 teca:field_information_resource_date:format_date: Format date plugin could not transform 'Février 
2015' using the format 'F Y'. Error: The date cannot be created from a format.
</pre>
</div></li>
<li>Explanation:
<ol class="org-ol">
<li>Some entries don't follow the general formatting of 'F Y' (written month in English and Year)</li>
<li>Some entries have trailing or leading whitespaces. In this particular case the <code>trim</code> function of Drupal migrate didn't remove them, because they are non-standard whitespaces</li>
<li>Some Month names are written in French</li>
</ol></li>
<li>Solution: In this case it was only a handful of entries and I fixed them manually. In general this should be flagged to whoever was/is curating the original data</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org811993a" class="outline-3">
<h3 id="org811993a"><span class="section-number-3">2.5.</span> Gemini API changed</h3>
<div class="outline-text-3" id="text-2-5">
<ul class="org-ul">
<li>this seems to be the case quite often</li>
<li></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org2cb9d64" class="outline-2">
<h2 id="org2cb9d64"><span class="section-number-2">3.</span> How to change taxonomy terms&#xa0;&#xa0;&#xa0;<span class="tag"><span class="drupal">drupal</span></span></h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li>Web menu -&gt; Structure -&gt; Taxonomy -&gt; &lt;AFS innovation use cases&gt;</li>
</ul>
</div>
<div id="outline-container-org1a0e04f" class="outline-3">
<h3 id="org1a0e04f"><span class="section-number-3">3.1.</span> Custom Taxonomy</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>Structure -&gt; Taxonomy -&gt; Create vocabulary</li>
<li>Add terms manually one by one
<ul class="org-ul">
<li>Faster alternative (deactivated): Extend -&gt; Taxonomy Manager
<ol class="org-ol">
<li>Install</li>
<li>Structure -&gt; Taxonomy Manager -&gt; &lt;new category&gt; -&gt; paste \n - separated list</li>
<li>Structure -&gt; Content types -&gt; original record -&gt; create new fields</li>
<li>Structure -&gt; Content types -&gt; ai-extracted record -&gt; create new fields</li>
<li>Structure -&gt; Content types -&gt; innovation -&gt; create new fields</li>
<li>Change ECA; add the new</li>
</ol></li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2025-10-08 Wed 15:30</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
